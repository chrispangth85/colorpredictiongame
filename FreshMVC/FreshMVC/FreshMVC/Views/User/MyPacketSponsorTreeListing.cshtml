@using FreshMVC.Models
@using resSharedPB = FreshMVC.Resources.PackBuddyShared;
@model SponsorChartModel
@inject IJsonHelper Json;

<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Homepage - HotMall</title>
    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
            integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
          integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g=="
          crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Favicons -->
    <link rel="apple-touch-icon" href="~/HotMall/img/logosmall.png" sizes="180x180">
    <link rel="icon" href="~/HotMall/img/logosmall.png" sizes="32x32" type="image/png">
    <link rel="icon" href="~/HotMall/img/logosmall.png" sizes="16x16" type="image/png">

    <script type="text/javascript">

        $(document).ready(function () {

            $(".redpacketSendByLevel").click(function (evt) {
                var level = $(this).attr("levelz");
                var upIDEnc = document.getElementById("UpIDEnc").value;
                Swal.fire({
                    title: "@resSharedPB.lblAmount",
                    input: 'number',
                    inputValue: 10,
                    inputAttributes: {
                        autocapitalize: 'off'
                    },
                    showCancelButton: true,
                    //confirmButtonText: 'Look up',
                    //showLoaderOnConfirm: true,
                    allowOutsideClick: () => !Swal.isLoading()
                }).then((result) => {
                    if (result.isConfirmed) {
                        $.ajax({
                            type: "POST",
                            url: "/User/SendRedPacketByLevel",
                            data: { UpIDEnc: upIDEnc, level: level, amount: result.value },
                            success: function (data) {
                                Swal.fire({
                                    title: '@resSharedPB.msgSuccesfullySent',
                                    showDenyButton: false,
                                    showCancelButton: false,
                                    confirmButtonText: 'OK',
                                }).then((result1) => {
                                    /* Read more about isConfirmed, isDenied below */
                                    if (result1.isConfirmed) {
                                        location.href = "/User/MyPacketSponsorTreeListing?upIDEnc=" + upIDEnc;
                                    }
                                });
                            },
                            error: function (xhr, status, error) {
                                $('.loader-wrap').hide();
                                let r = jQuery.parseJSON(xhr.responseText);
                                var errorM = r.message;
                                Swal.fire(
                                    '',
                                    errorM,
                                    'info'
                                )
                            }
                        });

                    }
                });

            });

            $(".redpacketIndividual").click(function (evt) {
                var idEnc = $(this).attr("encryUserz");
                var upIDEnc = document.getElementById("UpIDEnc").value;

                Swal.fire({
                    title: "@resSharedPB.lblAmount",
                    input: 'number',
                    inputValue: 10,
                    inputAttributes: {
                        autocapitalize: 'off'
                    },
                    showCancelButton: true,
                    //confirmButtonText: 'Look up',
                    //showLoaderOnConfirm: true,
                    allowOutsideClick: () => !Swal.isLoading()
                }).then((result) => {
                    if (result.isConfirmed) {
                        $.ajax({
                            type: "POST",
                            url: "/User/SendRedPacket",
                            data: { IDEnc: idEnc, amount: result.value },
                            success: function (data) {
                                Swal.fire({
                                    title: '@resSharedPB.msgSuccesfullySent',
                                    showDenyButton: false,
                                    showCancelButton: false,
                                    confirmButtonText: 'OK',
                                }).then((result2) => {
                                    /* Read more about isConfirmed, isDenied below */
                                    if (result2.isConfirmed) {
                                        location.href = "/User/MyPacketSponsorTreeListing?upIDEnc=" + upIDEnc;
                                    }
                                });
                            },
                            error: function (xhr, status, error) {
                                $('.loader-wrap').hide();
                                let r = jQuery.parseJSON(xhr.responseText);
                                var errorM = r.message;
                                Swal.fire(
                                    '',
                                    errorM,
                                    'info'
                                )
                            }
                        });

                    }
                });
            });

        });



    </script>
</head>

<body>
    @Html.Partial("HeaderMenu")
    @Html.HiddenFor(m => m.UpIDEnc)
    <main>
        <div class="section-inner-wrapper padding-s" style="overflow: visible;">
            <div class="display-space">
                <div class="middle">
                </div>
                <div>
                    <div class="d-flex flex-column ">
                        <div class="text-bold text-s">@resSharedPB.lblAvailRedPacketBalance</div>
                        <h2 class="text-m">₹ @Model.RedPacketBalance</h2>
                    </div>
                </div>
                <div class="recharge-history">
                    <button type="button" class="btn btn-link menu-btn">
                    </button>
                </div>
            </div>
        </div>
        <div class="section-inner-wrapper padding-s" style="overflow: visible;">
            <div class="display-space">
                <div class="middle">
                </div>
                <div>
                    <div class="d-flex flex-column ">
                        <div class="text-bold text-s">@resSharedPB.lblIntro</div>
                        <h2 class="text-m">@Model.Upline</h2>
                    </div>
                </div>
                <div class="recharge-history">
                    <button type="button" class="btn btn-link menu-btn">
                    </button>
                </div>
            </div>
        </div>
        <div class="section-inner-wrapper padding-s" style="overflow: visible;">
            <div class="display-space">
                <div class="middle">
                </div>
                <div>
                    <div class="d-flex flex-column ">
                        <h2 class="text-m">First Level</h2>
                    </div>
                </div>
                <div class="recharge-history">
                    <a class="redpacketSendByLevel" levelz="1">Give all this level</a>
                </div>
            </div>
        </div>
        <div class="col-lg-8 mx-auto">
            @foreach (var itemz in Model.FirstLevel)
            {
                <div class="record-card mt-3">
                    <p class="record-text">@resSharedPB.lblUsername : <span>@itemz.Username</span></p>
                    <a class="redpacketIndividual" encryUserz="@itemz.EncryptedUsername">Give Packet</a>
                    <br />
                    <a href="/User/MyPacketSponsorTreeListing?upIDEnc=@itemz.EncryptedUsername">Navigate</a>
                </div>
            }
        </div>
        <br />
        <div class="section-inner-wrapper padding-s" style="overflow: visible;">
            <div class="display-space">
                <div class="middle">
                </div>
                <div>
                    <div class="d-flex flex-column ">
                        <h2 class="text-m">Second Level</h2>
                    </div>
                </div>
                <div class="recharge-history">
                    <a class="redpacketSendByLevel" levelz="2">Give all this level</a>
                </div>
            </div>
        </div>
        <div class="col-lg-8 mx-auto">
            @foreach (var itemz in Model.SecondLevel)
            {
                <div class="record-card mt-3">
                    <p class="record-text">@resSharedPB.lblUsername : <span>@itemz.Username</span></p>
                    <a class="redpacketIndividual" encryUserz="@itemz.EncryptedUsername">Give Packet</a>
                    <br />
                    <a href="/User/MyPacketSponsorTreeListing?upIDEnc=@itemz.EncryptedUsername">Navigate</a>
                </div>
            }
        </div>
        <br />
        <div class="section-inner-wrapper padding-s" style="overflow: visible;">
            <div class="display-space">
                <div class="middle">
                </div>
                <div>
                    <div class="d-flex flex-column ">
                        <h2 class="text-m">Third Level</h2>
                    </div>
                </div>
                <div class="recharge-history">
                    <a class="redpacketSendByLevel" levelz="3">Give all this level</a>
                </div>
            </div>
        </div>
        <div class="col-lg-8 mx-auto">
            @foreach (var itemz in Model.ThirdLevel)
            {
                <div class="record-card mt-3">
                    <p class="record-text">@resSharedPB.lblUsername : <span>@itemz.Username</span></p>
                    <a class="redpacketIndividual" encryUserz="@itemz.EncryptedUsername">Give Packet</a>
                    <br />
                    <a href="/User/MyPacketSponsorTreeListing?upIDEnc=@itemz.EncryptedUsername">Navigate</a>
                </div>
            }
        </div>
        <br />
        <div class="section-inner-wrapper padding-s" style="overflow: visible;">
            <div class="display-space">
                <div class="middle">
                </div>
                <div>
                    <div class="d-flex flex-column ">
                        <h2 class="text-m">Fourth Level</h2>
                    </div>
                </div>
                <div class="recharge-history">
                    <a class="redpacketSendByLevel" levelz="4">Give all this level</a>
                </div>
            </div>
        </div>
        <div class="col-lg-8 mx-auto">
            @foreach (var itemz in Model.FourthLevel)
            {
                <div class="record-card mt-3">
                    <p class="record-text">@resSharedPB.lblUsername : <span>@itemz.Username</span></p>
                    <a class="redpacketIndividual" encryUserz="@itemz.EncryptedUsername">Give Packet</a>
                    <br />
                    <a href="/User/MyPacketSponsorTreeListing?upIDEnc=@itemz.EncryptedUsername">Navigate</a>
                </div>
            }
        </div>
        <br />
        <div class="section-inner-wrapper padding-s" style="overflow: visible;">
            <div class="display-space">
                <div class="middle">
                </div>
                <div>
                    <div class="d-flex flex-column ">
                        <h2 class="text-m">Fifth Level</h2>
                    </div>
                </div>
                <div class="recharge-history">
                    <a class="redpacketSendByLevel" levelz="5">Give all this level</a>
                </div>
            </div>
        </div>
        <div class="col-lg-8 mx-auto">
            @foreach (var itemz in Model.FifthLevel)
            {
                <div class="record-card mt-3">
                    <p class="record-text">@resSharedPB.lblUsername : <span>@itemz.Username</span></p>
                    <a class="redpacketIndividual" encryUserz="@itemz.EncryptedUsername">Give Packet</a>
                    <br />
                    <a href="/User/MyPacketSponsorTreeListing?upIDEnc=@itemz.EncryptedUsername">Navigate</a>
                </div>
            }
        </div>
        <br />
    </main>

    @Html.Partial("FooterMenu")

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"></script>
    <link rel="stylesheet" href="~/HotMall/flickity/flickity.css">
    <script src="~/HotMall/flickity/flickity.pkgd.min.js"></script>
    <script src="~/HotMall/main.js" type="text/javascript"></script>
    <script>
        $(window).on("load", function (e) {
            $("#loader-wrapper").fadeOut("fast");
        })

    </script>
</body>

</html>